# 🌊 ディープダイブ サバイバル - Deep Dive Survival

Firebase Realtime Databaseを使用したリアルタイムマルチプレイヤー深海潜水サバイバルゲームです。

---

## 📋 基本情報

| 項目 | 内容 |
|------|------|
| **ゲーム名** | ディープダイブ サバイバル (Deep Dive Survival) |
| **ジャンル** | オンライン協力型アクションサバイバル |
| **プラットフォーム** | Webブラウザ（スマートフォン対応） |
| **プレイ人数** | 1〜4人（オンラインマルチプレイ対応） |
| **技術スタック** | HTML5 Canvas, JavaScript (Vanilla), Firebase Realtime Database |

---

## 🎮 ゲーム概要

深海に潜っていくサバイバルアクションゲーム。プレイヤーは酸素を管理しながら、敵の海洋生物を避けたり倒したりして、より深い海底を目指します。オンライン協力プレイに対応しており、複数人で同時にプレイ可能です。

### クリア条件
- **最深部到達**: 深度1000m（Deepest Point）にある「海底遺跡」に到達するとゲームクリア

### ルール詳細
- **マルチプレイヤー**: ブラウザを変えてアクセスすると、みんなで協力して潜れます
- **縦スクロール**: 縦長のステージを下へ下へと潜っていきます
- **酸素管理**: 酸素ゲージを常に意識しながらサバイバル
- **スマホ対応**: タッチ操作で直感的にプレイ可能

---

## 🕹️ 操作方法

### スマートフォン / タブレット

| 操作 | アクション |
|------|------------|
| **タップ（画面左側）** | 左へ移動 |
| **タップ（画面右側）** | 右へ移動 |
| **長押し** | 浮上（上方向へ移動） |
| **下方向へスワイプ** | 攻撃（下方向へ銃弾発射） |

### デスクトップ

| 操作 | アクション |
|------|------------|
| **クリック（画面左側）** | 左へ移動 |
| **クリック（画面右側）** | 右へ移動 |
| **クリック長押し** | 浮上 |
| **マウス下ドラッグ** | 攻撃 |

---

## 📊 ゲームシステム

### 酸素ゲージ & 協力システム（重要）

| 項目 | 内容 |
|------|------|
| **最大値** | 100% |
| **自然消費** | 時間経過で徐々に減少（1秒ごとに約1%消費） |
| **深度影響** | 深くなるほど消費速度が増加 |
| **回復手段① アイテム** | 泡アイテムを取得する |
| **回復手段② 海面** | 海面（深度0m）まで戻ると**全回復** |
| **回復手段③ シェア** | **超重要協力アクション**<br>死亡（酸素0）した仲間に接触すると酸素を分け与えて蘇生できる。<br>・分け与える側: **-25%** 消費<br>・受け取る側（蘇生）: **+50%** 回復<br>→ システム全体で酸素が+25%増えるため、積極的に助け合うと有利！ |
| **0%時** | 行動不能（死亡状態）。味方に助けてもらうまで動けない。 |

#### 深度別酸素消費速度
| ゾーン | 深度 | 消費倍率 |
|--------|------|----------|
| 浅瀬 | 0〜100m | ×1.0 |
| 中層 | 100〜300m | ×1.5 |
| 深海 | 300〜600m | ×2.0 |
| 深淵 | 600m〜 | ×3.0 |

### 体力（HP）

| 項目 | 内容 |
|------|------|
| **最大値** | 3（ハート表示） |
| **ダメージ** | 敵に接触すると1ダメージ |
| **回復方法** | 回復アイテムを取得 |
| **無敵時間** | ダメージ後約1秒間 |
| **0時** | 酸素が残っていてもゲームオーバー（要救助状態へ） |

### 敵キャラクター仕様
- **リスポーンなし**: 敵は一度倒すと復活しません。
- **殲滅のメリット**: 倒せば倒すほど帰りのルートや後続のプレイヤーが安全になります。

### スコアシステム

| ボーナス種別 | スコア |
|--------------|--------|
| 深度1mあたり | +1点 |
| 最深部到達 | +10000点 |
| 小魚撃破 | +10点 |
| クラゲ撃破 | +20点 |
| サメ撃破 | +50点 |
| アンコウ撃破 | +100点 |
| 大王イカ撃破 | +500点 |
| コイン取得 | +100点 |
| 宝箱取得 | +200点 |

---

## 🗺️ ステージ構成

### 画面構成
- **表示形式**: 縦長の画面（ポートレート向け）
- **スクロール**: 下方向へ自動スクロール（プレイヤーが潜っていく演出）
- **背景演出**: 深度に応じて徐々に暗くなる

### 深度ゾーン詳細

| ゾーン | 深度 | 背景色 | 特徴 |
|--------|------|--------|------|
| **浅瀬** | 0〜100m | 明るい青 (#4A90D9) | 敵少ない、酸素消費遅い、チュートリアル的 |
| **中層** | 100〜300m | 濃い青 (#2D5986) | 敵普通、クラゲ出現開始 |
| **深海** | 300〜600m | 紺色 (#1A3A5C) | 敵多い、サメ出現、酸素消費速い |
| **深淵** | 600m〜 | 黒に近い青 (#0D1F33) | 極暗い、アンコウ・大王イカ出現 |

---

## 🐟 敵キャラクター

| 敵名 | アイコン | 出現ゾーン | 行動パターン | HP | 撃破スコア |
|------|----------|------------|--------------|-----|-----------|
| **小魚** | 🐟 | 浅瀬〜 | 左右に直進移動 | 1 | 10点 |
| **クラゲ** | 🪼 | 中層〜 | ふわふわ漂う、接触でダメージ | 2 | 20点 |
| **サメ** | 🦈 | 深海〜 | プレイヤーを追尾 | 3 | 50点 |
| **アンコウ** | 🐡 | 深淵 | 光でプレイヤーを誘い込む | 5 | 100点 |
| **大王イカ** | 🦑 | 深淵（ボス） | 触手で広範囲攻撃 | 10 | 500点 |

### 敵出現率（1秒あたり）

| ゾーン | 小魚 | クラゲ | サメ | アンコウ |
|--------|------|--------|------|----------|
| 浅瀬 | 20% | - | - | - |
| 中層 | 25% | 15% | - | - |
| 深海 | 30% | 20% | 10% | - |
| 深淵 | 25% | 25% | 15% | 5% |

---

## 💎 アイテム

| アイテム | アイコン | 出現率 | 効果 |
|----------|----------|--------|------|
| **泡（小）** | 🫧 | 高 | 酸素+10% |
| **泡（大）** | 🫧🫧 | 中 | 酸素+30% |
| **酸素ボンベ** | 🧪 | 低 | 酸素+50% |
| **回復アイテム** | ❤️ | 低 | HP+1（最大3まで） |
| **弾薬補給** | 🔫 | 中 | 弾薬+10発 |
| **コイン** | 💰 | 中 | スコア+100点 |
| **宝箱** | 📦 | 極低 | ランダム報酬（酸素/HP/弾薬/スコア） |

### アイテム出現間隔
- 泡系（小/大）: 2〜5秒ごと
- その他: 5〜15秒ごと

---

## 🔫 攻撃システム

| 項目 | 内容 |
|------|------|
| **攻撃方向** | 下方向のみ（銃弾を下に発射） |
| **初期弾薬数** | 30発 |
| **最大弾薬数** | 99発 |
| **弾速** | 400px/秒 |
| **連射制限** | 0.3秒に1発 |
| **ダメージ** | 1発あたり1ダメージ |

---

## 👥 マルチプレイヤー機能

### Firebase Realtime Database同期データ

| データ種別 | 同期頻度 | 内容 |
|------------|----------|------|
| **プレイヤー位置** | 60fps | x座標、y座標 |
| **プレイヤー状態** | 変化時 | HP、酸素、スコア、生存状態 |
| **敵の状態** | 60fps | 位置、HP、種類 |
| **アイテムの状態** | 変化時 | 位置、取得状況 |
| **弾丸** | 発射時 | 発射位置、方向 |

### ルーム機能

| 項目 | 内容 |
|------|------|
| **ルーム作成** | ランダム4桁コード自動生成 |
| **ルーム参加** | コード入力で参加 |
| **最大人数** | 4人 |
| **ホスト権限** | ゲーム開始、設定変更 |

### 協力要素

- **スコア共有**: チーム合計スコアをリアルタイム表示
- **復活システム**: 味方プレイヤーが近くにいると5秒後に復活可能
- **敵HP共有**: 複数人で同じ敵を攻撃可能

---

## 📱 UI/UX設計

### 画面レイアウト

```
┌─────────────────────────────────┐
│  SCORE: 0000   DEPTH: 000m      │ ← 上部UI（スコア・深度）
├─────────────────────────────────┤
│                                 │
│        ゲームエリア              │
│      (縦長キャンバス)            │
│                                 │
│     🫧    🐟                    │
│                                 │
│    👤 ← プレイヤー（ダイバー）    │
│                🦈              │
│                                 │
│  💰         🫧                  │
│                                 │
├─────────────────────────────────┤
│ ❤️❤️❤️       [O2 ████████ 85%]  │ ← 下部UI
│ 🔫 30                           │
└─────────────────────────────────┘
```

### カラーパレット

| 用途 | 色コード | 色名 |
|------|----------|------|
| 浅瀬背景 | #4A90D9 | 明るい青 |
| 中層背景 | #2D5986 | 濃い青 |
| 深海背景 | #1A3A5C | 紺色 |
| 深淵背景 | #0D1F33 | 黒に近い青 |
| UI背景 | rgba(0,0,0,0.5) | 半透明黒 |
| 酸素ゲージ | #00BFFF | ディープスカイブルー |
| HPゲージ | #FF4444 | 赤 |
| テキスト | #FFFFFF | 白 |

---

## 🛠️ 技術仕様

### ファイル構成

```
deepsea-firebase/
├── index.html          # メインHTML
├── style.css           # スタイルシート
├── deepsea-script.js   # ゲームロジック
├── game-config.js      # ゲーム設定（調整用パラメータ）
├── README.md           # この仕様書
├── package.json        # npm設定
├── firebase.json       # Firebase Hosting設定
├── .firebaserc         # Firebaseプロジェクト設定
├── database.rules.json # Firebase Realtime Database ルール
└── assets/             # 画像アセット
    ├── player.png         # プレイヤー（ダイバー）
    ├── bubble-small.png   # 泡（小）
    ├── bubble-large.png   # 泡（大）
    ├── background.png     # 背景
    └── enemies/
        ├── fish.png       # 小魚
        ├── jellyfish.png  # クラゲ
        ├── shark.png      # サメ
        ├── anglerfish.png # アンコウ
        └── squid.png      # 大王イカ
```

### ゲームループ処理順序

1. 入力処理（タップ、長押し、スワイプ検出）
2. プレイヤー移動処理
3. 酸素消費処理
4. 深度更新処理
5. 敵生成処理
6. アイテム生成処理
7. 弾丸移動処理
8. 衝突判定（プレイヤー vs 敵）
9. 衝突判定（弾丸 vs 敵）
10. 衝突判定（プレイヤー vs アイテム）
11. Firebase同期（送信）
12. Firebase同期（受信・他プレイヤー反映）
13. 画面描画
14. UI更新

---

## 🚀 実行方法

### ローカル開発

```bash
# Firebase CLIでローカル起動
firebase serve

# または npm スクリプト
npm start
```

### デプロイ

```bash
firebase deploy
```

---

## 🔄 実装優先順位

### Phase 1: 基本機能 ✅ 仕様策定完了
- [ ] プロジェクトセットアップ
- [ ] プレイヤー表示・移動（タップ、長押し）
- [ ] 酸素ゲージシステム
- [ ] 基本的な敵の生成・移動
- [ ] 泡アイテムの生成・取得

### Phase 2: ゲーム性向上
- [ ] 攻撃システム（下スワイプで発射）
- [ ] 全アイテム実装
- [ ] スコアシステム
- [ ] 深度ゾーン演出（背景変化）
- [ ] 敵の種類追加

### Phase 3: マルチプレイヤー
- [ ] Firebase連携セットアップ
- [ ] ルーム作成・参加機能
- [ ] プレイヤー位置同期
- [ ] 敵・アイテム状態同期
- [ ] 協力要素（復活など）

### Phase 4: ポリッシュ
- [ ] サウンドエフェクト
- [ ] ビジュアルエフェクト
- [ ] チュートリアル
- [ ] HP（SGGameSite）への統合
- [ ] パフォーマンス最適化

---

## 📝 変更履歴

| 日付 | バージョン | 内容 |
|------|------------|------|
| 2026/01/25 | 0.1.0 | 初版仕様策定 |

---

## 👤 制作

**SPIRAL GEAR GAME**  
🐦 X (Twitter): [@SGGame9](https://x.com/SGGame9)
